# AI instructions for ai-gene-review

## Project Overview

This project is for managing AI reviews of gene annotations. The overall goal is to both
review existing GO annotations using strict defined criteria, and to summarize the resulting
high quality annotations.

## Repository layout

src/
  ai_gene_review/
    schema/
      gene_review.yaml <-- linkml schema for review docs
genes/
  human/
    CFAP300/
      CFAP300-notes.md <-- keep your notes here
      CFAP300-ai-review.yaml <-- the output of your AI review
      CFAP300-notes.md <-- your own notes, edit this, use it like a journal and keep appending.
      CFAP300-uniprot.txt <-- the uniprot record downloaded from the UniProt website (do not edit this file)
      CFAP300-goa.tsv <-- the GO annotation downloaded from the QuickGO API (do not edit this file, no need to view it)
      CFAP300-deep-research.md <-- the deep research for the gene review (do not edit this file, it is automatically generated for you)
      CFAP300-citations.md <-- the citations for the gene review (do not edit this file)
      CFAP300-bioinformatics/ <-- the folder for any bioinformatics analyses (create this if necessary)
    <other genes>/
      ...
  worms/
    lrx-1/
      ...
publications/
  PMID_123456.md <-- cached publication text (this should be available for you)


You can regenerate the derived files by running commands like:

```
just fetch-gene human CFAP300 
```

This makes the uniprot, goa, and citations files. It will also create a stub for the gene review if it doesn't exist.

After making edits to the yaml file, you can validate the file by running:

```
just validate human CFAP300
```

This ensures that the yaml file is consistent with the schema in `src/ai_gene_review/schema/gene_review.yaml`, and also
that it implements best practices.

To validate all files, run:

```
just validate-all
```

* All gene symbols follow the standard nomenclature for that species. For human, should be HGNC symbols.

## Gene Review Guidelines

Your job is to review existing annotations for a gene, following GO guidelines, and synthesize these with what is known in the literature,
and what can be inferred bioinformatically. The general structure of the review is as follows:

```yaml
id: <uniprot id>
gene_symbol: <HGNC symbol>
taxon:
  id: <NCBI taxon id>
  label: <taxon label>
description: <your own summary of the gene>
references:
  <all relevant reference, including both literature and bioinformatics sources; includes all but not limited to those used in existing_annotations>
existing_annotations:
  <review of existing annotations, using the GO guidelines; should include all annotations from goa.csv>
core_functions:
  <your own summary of the core functions of the gene>
```

See the schema and existing files for more details (there are only a few files to look at for now, so all count as exemplars, we will
annotate exemplars more later on)

When creating a new review, always make sure files are in place:

`just fetch-gene <organism> <gene>`

This creates the uniprot, goa files, and a stub for the gene review.

The next thing is for you to do deep research on that gene and make a GENE-notes.md file, with citations inline (e.g [PMID:12345 title, "<supporting text>"]).

## Reviewing existing annotations

You should start with the ai-review.yaml file, where stubs are created for you (from `just fetch-gene <organism> <gene>`). Any PMID cited should
be in the publications folder, e.g. `publications/PMID_123456.md`. Review these.

A deep research file should already be present in the gene folder, e.g. `genes/SPECIES/GENE/GENE-deep-research.md`. This should contain a summary of the
literature, and any other information you found useful for the review. There may be irrelevant information in the citations, that is OK. If this is
not present, make your own and keep notes in `genes/SPECIES/GENE/GENE-notes.md`.

Be aware that many GO terms are over-annotations. You should also not take existing annotations as gospel, whether experimental or bioinformatic.
always use a holistic synthesized picture of the gene function that you have obtained from your research.

```yaml
ActionEnum:
    permissible_values:
      ACCEPT:
        description: Accept the existing annotation as-is, no modifications, and retain as representing the core function of the gene
      KEEP_AS_NON_CORE:
        description: Keep the existing annotation as-is, but mark it as non-core. For pleiotropic genes, this may be the developmental
          processes, or other processes that are not the core function of the gene.
      REMOVE:
        description: Remove the existing annotation, as it is unlikely to be correct based on combined evidence
      MODIFY:
        description: The essence of the annotation is sound, but there are better terms to use (use in combination with proposed_replacement_terms).
          if the term is too general, then MODIFY should be used, with a proposed replacement term for the correct specific function.
          sometimes terms can also be overly specific and contorted, so in some cases you might want to generalize
      MARK_AS_OVER_ANNOTATED:
        description: The term is not entirely wrong, but likely represents an over-annotation of the gene
      UNDECIDED:
        description: The annotation is not clear, and the reviewer is not sure what to do with it. ALWAYS USE THIS IF YOU ARE UNABLE TO ACCESS
          RELEVANT PUBLICATIONS
```      

## Tools

Use the OLS MCP to find relevant ontology terms, if the terms you need are not in existing_annotations.

## Curation guidelines

Avoid the term `protein binding`, this doesn't tell us anything about the actual function. Instead find a more
informative MF term (e.g for adapter function)

## Bioinformatics analyses

In some cases, it may be useful to do additional bioinformatics analyses. To validate gene function. Here are some guidelines:

For a gene-specific analysis, the folder is `<genes/specues/GENE>-bioinformatics/`. You should make this be reproducible. You can do a `uv init`
here and `uv add` for any packages you need.

Never hardcode the results of the script, it's OK for a script to return inconclusive results. Never ever make up results.

**IMPORTANT**: DO NOT write scripts that just tell users to go to a website. If you cannot programmatically call a tool (e.g., requires API keys, browser interaction, or authentication you don't have), then:
1. Be honest about this limitation upfront
2. Write scripts that can parse/process the output from the tool if the user runs it manually
3. Never write misleading code that pretends to do something it doesn't actually do

You can summarize the results of the bioinformatics analyses in the `<GENE>-bioinformatics/RESULTS.md` file. This can be referenced as any other reference
as e.g `file:<SPECIES>/<GENE>/bioinformatics/RESULTS.md`.

## General guidelines

* NEVER guess identifiers for terms, genes, publications. Always use the relevant tools or MCPS, or look them up in derived files.
* For files `<GENE>-notes.md`, use literature deep search, and always record provenance for assertions, e.g `[PMID:12345 "<supporting text>"]`



## Support code

There is also support code in `src/ai_gene_review`, see the CLAUDE.md file in that directory for more details
on best practices for working with the code.


